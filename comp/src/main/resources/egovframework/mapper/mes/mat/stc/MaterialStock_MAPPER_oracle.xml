<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mes.mat.stc.service.impl.MaterialStockMapper">
	

	<resultMap id="materialStock" type="mes.mat.stc.service.MaterialStockVO">
		<result property="lotNum" column="LOT_NUM" />
		<result property="matCode" column="MAT_CODE" />
		<result property="matVol" column="MAT_VOL" />
	</resultMap>
	
	<insert id="insertMaterialStock">
		<![CDATA[
			INSERT INTO MATERIAL_STOCK 
				( LOT_NUM
				  , MAT_CODE
				  , MAT_VOL )
			VALUES ( #{lotNum}
				  , #{matCode}
				  , #{matVol} )
		]]>
	</insert>
	
	<update id="updateMaterialStock">
		<![CDATA[
			UPDATE MATERIAL_STOCK
			SET LOT_NUM=#{lotNum}
				, MAT_CODE=#{matCode}
				, MAT_VOL=#{matVol}
						WHERE LOT_NUM=#{lotNum}
								AND MAT_CODE=#{matCode}
				]]>
	</update>
	
	<delete id="deleteMaterialStock">
		<![CDATA[
			DELETE FROM MATERIAL_STOCK 
						WHERE LOT_NUM=#{lotNum}
								AND MAT_CODE=#{matCode}
				]]>
	</delete>
	
	<select id="selectMaterialStock" resultType="mes.mat.stc.service.MaterialStockVO">
		<![CDATA[
			SELECT
				LOT_NUM
				, MAT_CODE
				, MAT_VOL
			FROM MATERIAL_STOCK
						WHERE LOT_NUM=#{lotNum}
								AND MAT_CODE=#{matCode}
				]]>
	</select>
	
	<select id="selectMaterialStockList" parameterType="mes.mat.stc.service.MaterialStockVO" resultType="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
				SELECT
								LOT_NUM
								, MAT_CODE
								, MAT_VOL
						FROM MATERIAL_STOCK
				WHERE 1=1
				<if test="searchKeyword != null and searchKeyword != ''">
					<if test="searchCondition == 0">AND
						LOT_NUM = #{searchKeyword}
					</if>
					<if test="searchCondition == 1">AND
						MAT_CODE LIKE '%' || #{searchKeyword} || '%'
					</if>
				</if>
					ORDER BY 
						LOT_NUM DESC
							, MAT_CODE DESC
		
		<![CDATA[					
	) A WHERE ROWNUM <= #{lastIndex}
)WHERE RNUM > #{firstIndex}
]]>
	</select>	
	<select id="selectMaterialStockListTotCnt" parameterType="mes.mat.stc.service.MaterialStockVO" resultType="int">
			SELECT COUNT(*) totcnt
			FROM MATERIAL_STOCK
			WHERE 1=1
			<if test="searchKeyword != null and searchKeyword != ''">
				<if test="searchCondition == 0">AND
					LOT_NUM = #{searchKeyword}
				</if>
				<if test="searchCondition == 1">AND
					MAT_CODE LIKE '%' || #{searchKeyword} || '%'
				</if>
			</if>
	</select>

</mapper>
