<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="mes.mat.in.service.impl.MaterialHistoryDMapper">
	

	<resultMap id="materialHistoryD" type="mes.mat.in.service.MaterialHistoryDVO">
		<result property="matHisDNum" column="MAT_HIS_D_NUM" />
		<result property="matHisNum" column="MAT_HIS_NUM" />
		<result property="matCode" column="MAT_CODE" />
		<result property="matComNum" column="MAT_COM_NUM" />
		<result property="lotNo" column="LOT_NO" />
		<result property="matHisDVol" column="MAT_HIS_D_VOL" />
		<result property="matHisPrice" column="MAT_HIS_PRICE" />
		<result property="matOutOper" column="MAT_OUT_OPER" />
	</resultMap>
	
	<insert id="insertMaterialHistoryD">
		<![CDATA[
			INSERT INTO MATERIAL_HISTORY_D 
				( MAT_HIS_D_NUM
				  , MAT_HIS_NUM
				  , MAT_CODE
				  , MAT_COM_NUM
				  , LOT_NO
				  , MAT_HIS_D_VOL
				  , MAT_HIS_PRICE
				  , MAT_OUT_OPER )
			VALUES ( #{matHisDNum}
				  , #{matHisNum}
				  , #{matCode}
				  , #{matComNum}
				  , #{lotNo}
				  , #{matHisDVol}
				  , #{matHisPrice}
				  , #{matOutOper} )
		]]>
	</insert>
	
	<update id="updateMaterialHistoryD">
		<![CDATA[
			UPDATE MATERIAL_HISTORY_D
			SET MAT_HIS_D_NUM=#{matHisDNum}
				, MAT_HIS_NUM=#{matHisNum}
				, MAT_CODE=#{matCode}
				, MAT_COM_NUM=#{matComNum}
				, LOT_NO=#{lotNo}
				, MAT_HIS_D_VOL=#{matHisDVol}
				, MAT_HIS_PRICE=#{matHisPrice}
				, MAT_OUT_OPER=#{matOutOper}
						WHERE MAT_HIS_D_NUM=#{matHisDNum}
				]]>
	</update>
	
	<delete id="deleteMaterialHistoryD">
		<![CDATA[
			DELETE FROM MATERIAL_HISTORY_D 
						WHERE MAT_HIS_D_NUM=#{matHisDNum}
				]]>
	</delete>
	
	<select id="selectMaterialHistoryD" resultMap="materialHistoryD">
		<![CDATA[
			SELECT
				MAT_HIS_D_NUM
				, MAT_HIS_NUM
				, MAT_CODE
				, MAT_COM_NUM
				, LOT_NO
				, MAT_HIS_D_VOL
				, MAT_HIS_PRICE
				, MAT_OUT_OPER
			FROM MATERIAL_HISTORY_D
						WHERE MAT_HIS_D_NUM=#{matHisDNum}
				]]>
	</select>
	
	<select id="selectMaterialHistoryDList" parameterType="mes.mat.in.service.MaterialHistoryDVO" resultType="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
				SELECT
								MAT_HIS_D_NUM
								, MAT_HIS_NUM
								, MAT_CODE
								, MAT_COM_NUM
								, LOT_NO
								, MAT_HIS_D_VOL
								, MAT_HIS_PRICE
								, MAT_OUT_OPER
						FROM MATERIAL_HISTORY_D
				WHERE 1=1
				<if test="searchKeyword != null and searchKeyword != ''">
					<if test="searchCondition == 0">AND
						MAT_HIS_D_NUM = #{searchKeyword}
					</if>
					<if test="searchCondition == 1">AND
						MAT_HIS_NUM LIKE '%' || #{searchKeyword} || '%'
					</if>
				</if>
					ORDER BY 
						MAT_HIS_D_NUM DESC
		
		<![CDATA[					
	) A WHERE ROWNUM <= #{lastIndex}
)WHERE RNUM > #{firstIndex}
]]>
	</select>	
	<select id="selectMaterialHistoryDListTotCnt" parameterType="mes.mat.in.service.MaterialHistoryDVO" resultType="int">
			SELECT COUNT(*) totcnt
			FROM MATERIAL_HISTORY_D
			WHERE 1=1
			<if test="searchKeyword != null and searchKeyword != ''">
				<if test="searchCondition == 0">AND
					MAT_HIS_D_NUM = #{searchKeyword}
				</if>
				<if test="searchCondition == 1">AND
					MAT_HIS_NUM LIKE '%' || #{searchKeyword} || '%'
				</if>
			</if>
	</select>

</mapper>
