<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mes.mat.stc.service.impl.MaterialMapper">
	

	<resultMap id="material" type="mes.mat.stc.service.MaterialVO">
		<result property="matCode" column="mat_code" />
		<result property="operCode" column="oper_code" />
		<result property="matName" column="mat_name" />
		<result property="matBarcode" column="mat_barcode" />
		<result property="matSize" column="mat_size" />
		<result property="matUnit" column="mat_unit" />
		<result property="empId" column="emp_id" />
		<result property="matGrp" column="mat_grp" />
		<result property="matDiv" column="mat_div" />
		<result property="matKindDiv" column="mat_kind_div" />
		<result property="matUsing" column="mat_using" />
		<result property="matTesting" column="mat_testing" />
		<result property="cylinder" column="cylinder" />
		<result property="matLotDiv" column="mat_lot_div" />
		<result property="matSafeStockMag" column="mat_safe_stock_mag" />
		
	</resultMap>
	
	<insert id="insertMaterial">
		<![CDATA[
			INSERT INTO material 
				( mat_code
				  , oper_code
				  , mat_name
				  , mat_barcode
				  , mat_size
				  , mat_unit
				  , emp_id
				  , mat_grp
				  , mat_div
				  , mat_kind_div
				  , mat_using
				  , mat_testing
				  , cylinder
				  , mat_lot_div
				  , mat_safe_stock_mag
				   )
			VALUES ( #{matCode}
				  , #{operCode}
				  , #{matName}
				  , #{matBarcode}
				  , #{matSize}
				  , #{matUnit}
				  , #{empId}
				  , #{matGrp}
				  , #{matDiv}
				  , #{matKindDiv}
				  , #{matUsing}
				  , #{matTesting}
				  , #{cylinder}
				  , #{matLotDiv}
				  , #{matSafeStockMag}
				   )
		]]>
	</insert>
	
	<update id="updateMaterial">
		<![CDATA[
			UPDATE material
			SET mat_code=#{matCode}
				, oper_code=#{operCode}
				, mat_name=#{matName}
				, mat_barcode=#{matBarcode}
				, mat_size=#{matSize}
				, mat_unit=#{matUnit}
				, emp_id=#{empId}
				, mat_grp=#{matGrp}
				, mat_div=#{matDiv}
				, mat_kind_div=#{matKindDiv}
				, mat_using=#{matUsing}
				, mat_testing=#{matTesting}
				, cylinder=#{cylinder}
				, mat_lot_div=#{matLotDiv}
				, mat_safe_stock_mag=#{matSafeStockMag}
				
						WHERE mat_code=#{matCode}
				]]>
	</update>
	
	<delete id="deleteMaterial">
		<![CDATA[
			DELETE FROM material 
						WHERE mat_code=#{matCode}
				]]>
	</delete>
	
	<select id="selectMaterial" resultType="mes.mat.stc.service.MaterialVO">
		<![CDATA[
			SELECT
				mat_code
				, oper_code
				, mat_name
				, mat_barcode
				, mat_size
				, mat_unit
				, emp_id
				, mat_grp
				, mat_div
				, mat_kind_div
				, mat_using
				, mat_testing
				, cylinder
				, mat_lot_div
				, mat_safe_stock_mag
				
			FROM material 
						WHERE mat_code=#{matCode}
				]]>
	</select>
	
	<select id="selectMaterialList" parameterType="mes.mat.stc.service.MaterialVO" resultType="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
				SELECT
								mat_code
								, oper_code
								, mat_name
								, mat_barcode
								, mat_size
								, mat_unit
								, emp_id
								, mat_grp
								, mat_div
								, mat_kind_div
								, mat_using
								, mat_testing
								, cylinder
								, mat_lot_div
								, mat_safe_stock_mag
								
						FROM material
				WHERE 1=1
				<if test="searchKeyword != null and searchKeyword != ''">
					<if test="searchCondition == 0">AND
						mat_code = #{searchKeyword}
					</if>
					<if test="searchCondition == 1">AND
						oper_code LIKE '%' || #{searchKeyword} || '%'
					</if>
				</if>
					ORDER BY 
						mat_code DESC
		
		<![CDATA[					
	) A WHERE ROWNUM <= #{lastIndex}
)WHERE RNUM > #{firstIndex}
]]>
	</select>	
	<select id="selectMaterialListTotCnt" parameterType="mes.mat.stc.service.MaterialVO" resultType="int">
			SELECT COUNT(*) totcnt
			FROM material
			WHERE 1=1
			<if test="searchKeyword != null and searchKeyword != ''">
				<if test="searchCondition == 0">AND
					mat_code = #{searchKeyword}
				</if>
				<if test="searchCondition == 1">AND
					oper_code LIKE '%' || #{searchKeyword} || '%'
				</if>
			</if>
	</select>

</mapper>
