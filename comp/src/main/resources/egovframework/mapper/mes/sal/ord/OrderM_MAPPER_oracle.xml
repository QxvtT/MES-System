<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mes.sal.ord.service.impl.OrderMMapper">
	

	<resultMap id="orderM" type="mes.sal.ord.service.OrderMVO">
		<result property="ordNum" column="ORD_NUM" />
		<result property="ordRequestDate" column="ORD_REQUEST_DATE" />
		<result property="ordDeliveryDate" column="ORD_DELIVERY_DATE" />
		<result property="operCode" column="OPER_CODE" />
		<result property="operName" column="OPER_NAME" />
	</resultMap>
	
	<insert id="insertOrderM">
		<![CDATA[
			INSERT INTO ORDER_M 
				( ORD_NUM
				  , ORD_REQUEST_DATE
				  , ORD_DELIVERY_DATE
				  , OPER_CODE
				  , OPER_NAME )
			VALUES ( #{ordNum}
				  , #{ordRequestDate}
				  , #{ordDeliveryDate}
				  , #{operCode}
				  , #{operName} )
		]]>
	</insert>
	
	<update id="updateOrderM">
		<![CDATA[
			UPDATE ORDER_M
			SET ORD_NUM=#{ordNum}
				, ORD_REQUEST_DATE=#{ordRequestDate}
				, ORD_DELIVERY_DATE=#{ordDeliveryDate}
				, OPER_CODE=#{operCode}
				, OPER_NAME=#{operName}
						WHERE ORD_NUM=#{ordNum}
				]]>
	</update>
	
	<delete id="deleteOrderM">
		<![CDATA[
			DELETE FROM ORDER_M 
						WHERE ORD_NUM=#{ordNum}
				]]>
	</delete>
	
	<select id="selectOrderM" resultMap="orderM">
		<![CDATA[
			SELECT
				ORD_NUM
				, ORD_REQUEST_DATE
				, ORD_DELIVERY_DATE
				, OPER_CODE
				, OPER_NAME
			FROM ORDER_M
						WHERE ORD_NUM=#{ordNum}
				]]>
	</select>
	
	<select id="selectOrderMList" parameterType="mes.sal.ord.service.OrderMVO" resultType="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
				SELECT
								ORD_NUM
								, ORD_REQUEST_DATE
								, ORD_DELIVERY_DATE
								, OPER_CODE
								, OPER_NAME
						FROM ORDER_M
				WHERE 1=1
				<if test="searchKeyword != null and searchKeyword != ''">
					<if test="searchCondition == 0">AND
						ORD_NUM = #{searchKeyword}
					</if>
					<if test="searchCondition == 1">AND
						ORD_REQUEST_DATE LIKE '%' || #{searchKeyword} || '%'
					</if>
				</if>
					ORDER BY 
						ORD_NUM DESC
		
		<![CDATA[					
	) A WHERE ROWNUM <= #{lastIndex}
)WHERE RNUM > #{firstIndex}
]]>
	</select>	
	<select id="selectOrderMListTotCnt" parameterType="mes.sal.ord.service.OrderMVO" resultType="int">
			SELECT COUNT(*) totcnt
			FROM ORDER_M
			WHERE 1=1
			<if test="searchKeyword != null and searchKeyword != ''">
				<if test="searchCondition == 0">AND
					ORD_NUM = #{searchKeyword}
				</if>
				<if test="searchCondition == 1">AND
					ORD_REQUEST_DATE LIKE '%' || #{searchKeyword} || '%'
				</if>
			</if>
	</select>

</mapper>
